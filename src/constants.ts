import { Type } from "@google/genai";

/**
 * IEC 60364-5-52 Reference Data
 * Note: These are simplified representative values for common configurations.
 * In a real-world application, these would be exhaustive.
 */

export interface CableCapacity {
  size: number; // mm2
  capacity: number; // Amperes
}

export type InsulationType = 'PVC' | 'XLPE';
export type ConductorMaterial = 'Copper' | 'Aluminum';
export type InstallationMethod = 'A1' | 'A2' | 'B1' | 'B2' | 'C' | 'D' | 'E' | 'F' | 'G';

// Table B.52.4: Current-carrying capacities in amperes for methods A, B, C, D, E, F, G
// Copper conductors, PVC insulation, 3 loaded conductors, 30°C ambient
export const COPPER_PVC_3_LOADED: Record<InstallationMethod, CableCapacity[]> = {
  A1: [
    { size: 1.5, capacity: 13 },
    { size: 2.5, capacity: 17.5 },
    { size: 4, capacity: 23 },
    { size: 6, capacity: 29 },
    { size: 10, capacity: 39 },
    { size: 16, capacity: 52 },
    { size: 25, capacity: 68 },
    { size: 35, capacity: 83 },
    { size: 50, capacity: 99 },
    { size: 70, capacity: 125 },
    { size: 95, capacity: 150 },
    { size: 120, capacity: 172 },
    { size: 150, capacity: 196 },
    { size: 185, capacity: 223 },
    { size: 240, capacity: 261 },
    { size: 300, capacity: 296 },
  ],
  A2: [
    { size: 1.5, capacity: 12 },
    { size: 2.5, capacity: 16.5 },
    { size: 4, capacity: 22 },
    { size: 6, capacity: 28 },
    { size: 10, capacity: 38 },
    { size: 16, capacity: 50 },
    { size: 25, capacity: 65 },
    { size: 35, capacity: 80 },
    { size: 50, capacity: 97 },
    { size: 70, capacity: 122 },
    { size: 95, capacity: 147 },
    { size: 120, capacity: 169 },
    { size: 150, capacity: 192 },
    { size: 185, capacity: 219 },
    { size: 240, capacity: 257 },
    { size: 300, capacity: 292 },
  ],
  B1: [
    { size: 1.5, capacity: 15.5 },
    { size: 2.5, capacity: 21 },
    { size: 4, capacity: 28 },
    { size: 6, capacity: 36 },
    { size: 10, capacity: 50 },
    { size: 16, capacity: 68 },
    { size: 25, capacity: 89 },
    { size: 35, capacity: 110 },
    { size: 50, capacity: 134 },
    { size: 70, capacity: 171 },
    { size: 95, capacity: 207 },
    { size: 120, capacity: 239 },
    { size: 150, capacity: 272 },
    { size: 185, capacity: 310 },
    { size: 240, capacity: 364 },
    { size: 300, capacity: 414 },
  ],
  B2: [
    { size: 1.5, capacity: 14.5 },
    { size: 2.5, capacity: 20 },
    { size: 4, capacity: 27 },
    { size: 6, capacity: 34 },
    { size: 10, capacity: 46 },
    { size: 16, capacity: 62 },
    { size: 25, capacity: 80 },
    { size: 35, capacity: 99 },
    { size: 50, capacity: 120 },
    { size: 70, capacity: 153 },
    { size: 95, capacity: 186 },
    { size: 120, capacity: 215 },
    { size: 150, capacity: 245 },
    { size: 185, capacity: 279 },
    { size: 240, capacity: 327 },
    { size: 300, capacity: 372 },
  ],
  C: [
    { size: 1.5, capacity: 17.5 },
    { size: 2.5, capacity: 24 },
    { size: 4, capacity: 32 },
    { size: 6, capacity: 41 },
    { size: 10, capacity: 57 },
    { size: 16, capacity: 76 },
    { size: 25, capacity: 101 },
    { size: 35, capacity: 125 },
    { size: 50, capacity: 151 },
    { size: 70, capacity: 192 },
    { size: 95, capacity: 232 },
    { size: 120, capacity: 269 },
    { size: 150, capacity: 300 },
    { size: 185, capacity: 341 },
    { size: 240, capacity: 400 },
    { size: 300, capacity: 452 },
  ],
  D: [
    { size: 1.5, capacity: 18 },
    { size: 2.5, capacity: 24 },
    { size: 4, capacity: 31 },
    { size: 6, capacity: 39 },
    { size: 10, capacity: 52 },
    { size: 16, capacity: 67 },
    { size: 25, capacity: 86 },
    { size: 35, capacity: 103 },
    { size: 50, capacity: 122 },
    { size: 70, capacity: 151 },
    { size: 95, capacity: 179 },
    { size: 120, capacity: 203 },
    { size: 150, capacity: 230 },
    { size: 185, capacity: 260 },
    { size: 240, capacity: 300 },
    { size: 300, capacity: 335 },
  ],
  E: [
    { size: 1.5, capacity: 18.5 },
    { size: 2.5, capacity: 25 },
    { size: 4, capacity: 34 },
    { size: 6, capacity: 43 },
    { size: 10, capacity: 60 },
    { size: 16, capacity: 80 },
    { size: 25, capacity: 106 },
    { size: 35, capacity: 131 },
    { size: 50, capacity: 159 },
    { size: 70, capacity: 202 },
    { size: 95, capacity: 244 },
    { size: 120, capacity: 282 },
    { size: 150, capacity: 324 },
    { size: 185, capacity: 371 },
    { size: 240, capacity: 439 },
    { size: 300, capacity: 495 },
  ],
  F: [
    { size: 1.5, capacity: 18.5 },
    { size: 2.5, capacity: 25 },
    { size: 4, capacity: 34 },
    { size: 6, capacity: 43 },
    { size: 10, capacity: 60 },
    { size: 16, capacity: 80 },
    { size: 25, capacity: 106 },
    { size: 35, capacity: 131 },
    { size: 50, capacity: 159 },
    { size: 70, capacity: 202 },
    { size: 95, capacity: 244 },
    { size: 120, capacity: 282 },
  ],
  G: [
    { size: 1.5, capacity: 22 },
    { size: 2.5, capacity: 30 },
    { size: 4, capacity: 40 },
    { size: 6, capacity: 51 },
    { size: 10, capacity: 70 },
    { size: 16, capacity: 94 },
    { size: 25, capacity: 124 },
    { size: 35, capacity: 154 },
    { size: 50, capacity: 187 },
    { size: 70, capacity: 238 },
    { size: 95, capacity: 289 },
    { size: 120, capacity: 335 },
    { size: 150, capacity: 386 },
    { size: 185, capacity: 441 },
    { size: 240, capacity: 523 },
    { size: 300, capacity: 590 },
  ],
};

// Table B.52.5: XLPE insulation, Copper, 3 loaded conductors, 30°C ambient
export const COPPER_XLPE_3_LOADED: Record<InstallationMethod, CableCapacity[]> = {
  A1: [
    { size: 1.5, capacity: 16 },
    { size: 2.5, capacity: 21 },
    { size: 4, capacity: 28 },
    { size: 6, capacity: 36 },
    { size: 10, capacity: 49 },
    { size: 16, capacity: 66 },
    { size: 25, capacity: 86 },
    { size: 35, capacity: 103 },
    { size: 50, capacity: 125 },
    { size: 70, capacity: 160 },
    { size: 95, capacity: 190 },
    { size: 120, capacity: 220 },
    { size: 150, capacity: 250 },
    { size: 185, capacity: 285 },
    { size: 240, capacity: 335 },
    { size: 300, capacity: 380 },
  ],
  A2: [
    { size: 1.5, capacity: 15 },
    { size: 2.5, capacity: 20 },
    { size: 4, capacity: 27 },
    { size: 6, capacity: 34 },
    { size: 10, capacity: 46 },
    { size: 16, capacity: 62 },
    { size: 25, capacity: 80 },
    { size: 35, capacity: 99 },
    { size: 50, capacity: 120 },
    { size: 70, capacity: 153 },
    { size: 95, capacity: 186 },
    { size: 120, capacity: 215 },
    { size: 150, capacity: 245 },
    { size: 185, capacity: 280 },
    { size: 240, capacity: 330 },
    { size: 300, capacity: 375 },
  ],
  B1: [
    { size: 1.5, capacity: 19 },
    { size: 2.5, capacity: 26 },
    { size: 4, capacity: 35 },
    { size: 6, capacity: 45 },
    { size: 10, capacity: 61 },
    { size: 16, capacity: 82 },
    { size: 25, capacity: 108 },
    { size: 35, capacity: 135 },
    { size: 50, capacity: 164 },
    { size: 70, capacity: 208 },
    { size: 95, capacity: 252 },
    { size: 120, capacity: 291 },
    { size: 150, capacity: 332 },
    { size: 185, capacity: 378 },
    { size: 240, capacity: 445 },
    { size: 300, capacity: 505 },
  ],
  B2: [
    { size: 1.5, capacity: 18.5 },
    { size: 2.5, capacity: 25 },
    { size: 4, capacity: 33 },
    { size: 6, capacity: 42 },
    { size: 10, capacity: 58 },
    { size: 16, capacity: 77 },
    { size: 25, capacity: 101 },
    { size: 35, capacity: 126 },
    { size: 50, capacity: 153 },
    { size: 70, capacity: 194 },
    { size: 95, capacity: 236 },
    { size: 120, capacity: 272 },
    { size: 150, capacity: 311 },
    { size: 185, capacity: 355 },
    { size: 240, capacity: 417 },
    { size: 300, capacity: 475 },
  ],
  C: [
    { size: 1.5, capacity: 22 },
    { size: 2.5, capacity: 30 },
    { size: 4, capacity: 40 },
    { size: 6, capacity: 52 },
    { size: 10, capacity: 71 },
    { size: 16, capacity: 96 },
    { size: 25, capacity: 127 },
    { size: 35, capacity: 157 },
    { size: 50, capacity: 190 },
    { size: 70, capacity: 242 },
    { size: 95, capacity: 293 },
    { size: 120, capacity: 339 },
    { size: 150, capacity: 389 },
    { size: 185, capacity: 444 },
    { size: 240, capacity: 522 },
    { size: 300, capacity: 590 },
  ],
  D: [
    { size: 1.5, capacity: 22 },
    { size: 2.5, capacity: 29 },
    { size: 4, capacity: 38 },
    { size: 6, capacity: 47 },
    { size: 10, capacity: 63 },
    { size: 16, capacity: 81 },
    { size: 25, capacity: 104 },
    { size: 35, capacity: 125 },
    { size: 50, capacity: 148 },
    { size: 70, capacity: 183 },
    { size: 95, capacity: 216 },
    { size: 120, capacity: 246 },
    { size: 150, capacity: 280 },
    { size: 185, capacity: 315 },
    { size: 240, capacity: 360 },
    { size: 300, capacity: 405 },
  ],
  E: [
    { size: 1.5, capacity: 23 },
    { size: 2.5, capacity: 31 },
    { size: 4, capacity: 42 },
    { size: 6, capacity: 54 },
    { size: 10, capacity: 75 },
    { size: 16, capacity: 100 },
    { size: 25, capacity: 133 },
    { size: 35, capacity: 164 },
    { size: 50, capacity: 198 },
    { size: 70, capacity: 253 },
    { size: 95, capacity: 306 },
    { size: 120, capacity: 354 },
    { size: 150, capacity: 406 },
    { size: 185, capacity: 463 },
    { size: 240, capacity: 546 },
    { size: 300, capacity: 620 },
  ],
  F: [
    { size: 1.5, capacity: 23 },
    { size: 2.5, capacity: 31 },
    { size: 4, capacity: 42 },
    { size: 6, capacity: 54 },
    { size: 10, capacity: 75 },
    { size: 16, capacity: 100 },
    { size: 25, capacity: 133 },
    { size: 35, capacity: 164 },
    { size: 50, capacity: 198 },
    { size: 70, capacity: 253 },
    { size: 95, capacity: 306 },
    { size: 120, capacity: 354 },
  ],
  G: [
    { size: 1.5, capacity: 26 },
    { size: 2.5, capacity: 36 },
    { size: 4, capacity: 49 },
    { size: 6, capacity: 63 },
    { size: 10, capacity: 86 },
    { size: 16, capacity: 115 },
    { size: 25, capacity: 152 },
    { size: 35, capacity: 189 },
    { size: 50, capacity: 228 },
    { size: 70, capacity: 291 },
    { size: 95, capacity: 354 },
    { size: 120, capacity: 410 },
    { size: 150, capacity: 470 },
    { size: 185, capacity: 536 },
    { size: 240, capacity: 632 },
    { size: 300, capacity: 715 },
  ],
};

// Ambient Temperature Correction Factors (Table B.52.14)
// Reference temperature 30°C
export const TEMP_CORRECTION_PVC: Record<number, number> = {
  10: 1.22,
  15: 1.17,
  20: 1.12,
  25: 1.06,
  30: 1.00,
  35: 0.94,
  40: 0.87,
  45: 0.79,
  50: 0.71,
  55: 0.61,
  60: 0.50,
};

export const TEMP_CORRECTION_XLPE: Record<number, number> = {
  10: 1.15,
  15: 1.12,
  20: 1.08,
  25: 1.04,
  30: 1.00,
  35: 0.96,
  40: 0.91,
  45: 0.87,
  50: 0.82,
  55: 0.76,
  60: 0.71,
  65: 0.65,
  70: 0.58,
  75: 0.50,
  80: 0.41,
};

// Grouping Correction Factors (Table B.52.17)
export const GROUPING_CORRECTION: Record<number, number> = {
  1: 1.00,
  2: 0.80,
  3: 0.70,
  4: 0.65,
  5: 0.60,
  6: 0.57,
  7: 0.54,
  8: 0.52,
  9: 0.50,
  12: 0.45,
  16: 0.41,
  20: 0.38,
};

// Aluminum, PVC, 3 loaded
export const ALUMINUM_PVC_3_LOADED: Record<InstallationMethod, CableCapacity[]> = {
  A1: [{size:2.5,capacity:13.5},{size:4,capacity:17.5},{size:6,capacity:23},{size:10,capacity:31},{size:16,capacity:41},{size:25,capacity:54},{size:35,capacity:66},{size:50,capacity:79},{size:70,capacity:100},{size:95,capacity:121},{size:120,capacity:139},{size:150,capacity:159},{size:185,capacity:181},{size:240,capacity:212}],
  A2: [{size:2.5,capacity:13},{size:4,capacity:17},{size:6,capacity:22},{size:10,capacity:30},{size:16,capacity:39},{size:25,capacity:51},{size:35,capacity:63},{size:50,capacity:76},{size:70,capacity:96},{size:95,capacity:116},{size:120,capacity:134},{size:150,capacity:153},{size:185,capacity:175},{size:240,capacity:205}],
  B1: [{size:2.5,capacity:16.5},{size:4,capacity:22},{size:6,capacity:28},{size:10,capacity:39},{size:16,capacity:53},{size:25,capacity:70},{size:35,capacity:86},{size:50,capacity:104},{size:70,capacity:133},{size:95,capacity:161},{size:120,capacity:186},{size:150,capacity:212},{size:185,capacity:242},{size:240,capacity:284}],
  B2: [{size:2.5,capacity:15.5},{size:4,capacity:21},{size:6,capacity:27},{size:10,capacity:36},{size:16,capacity:48},{size:25,capacity:63},{size:35,capacity:78},{size:50,capacity:94},{size:70,capacity:120},{size:95,capacity:145},{size:120,capacity:167},{size:150,capacity:191},{size:185,capacity:218},{size:240,capacity:256}],
  C: [{size:2.5,capacity:18.5},{size:4,capacity:25},{size:6,capacity:32},{size:10,capacity:44},{size:16,capacity:59},{size:25,capacity:79},{size:35,capacity:97},{size:50,capacity:117},{size:70,capacity:150},{size:95,capacity:181},{size:120,capacity:210},{size:150,capacity:240},{size:185,capacity:273},{size:240,capacity:321}],
  D: [{size:2.5,capacity:18.5},{size:4,capacity:24},{size:6,capacity:30},{size:10,capacity:40},{size:16,capacity:52},{size:25,capacity:67},{size:35,capacity:81},{size:50,capacity:96},{size:70,capacity:119},{size:95,capacity:141},{size:120,capacity:160},{size:150,capacity:182},{size:185,capacity:206},{size:240,capacity:238}],
  E: [{size:2.5,capacity:19.5},{size:4,capacity:26},{size:6,capacity:34},{size:10,capacity:47},{size:16,capacity:63},{size:25,capacity:83},{size:35,capacity:103},{size:50,capacity:125},{size:70,capacity:159},{size:95,capacity:192},{size:120,capacity:222},{size:150,capacity:255},{size:185,capacity:292},{size:240,capacity:345}],
  F: [{size:2.5,capacity:19.5},{size:4,capacity:26},{size:6,capacity:34},{size:10,capacity:47},{size:16,capacity:63},{size:25,capacity:83},{size:35,capacity:103},{size:50,capacity:125},{size:70,capacity:159},{size:95,capacity:192},{size:120,capacity:222},{size:150,capacity:255},{size:185,capacity:292},{size:240,capacity:345}],
  G: [{size:2.5,capacity:23},{size:4,capacity:31},{size:6,capacity:40},{size:10,capacity:55},{size:16,capacity:74},{size:25,capacity:98},{size:35,capacity:121},{size:50,capacity:147},{size:70,capacity:187},{size:95,capacity:227},{size:120,capacity:263},{size:150,capacity:303},{size:185,capacity:347},{size:240,capacity:411},{size:300,capacity:465}],
};

// Aluminum, XLPE, 3 loaded
export const ALUMINUM_XLPE_3_LOADED: Record<InstallationMethod, CableCapacity[]> = {
  A1: [{size:2.5,capacity:16.5},{size:4,capacity:22},{size:6,capacity:28},{size:10,capacity:38},{size:16,capacity:51},{size:25,capacity:67},{size:35,capacity:81},{size:50,capacity:98},{size:70,capacity:124},{size:95,capacity:148},{size:120,capacity:171},{size:150,capacity:195},{size:185,capacity:223},{size:240,capacity:262}],
  A2: [{size:2.5,capacity:15.5},{size:4,capacity:21},{size:6,capacity:27},{size:10,capacity:36},{size:16,capacity:48},{size:25,capacity:63},{size:35,capacity:77},{size:50,capacity:94},{size:70,capacity:119},{size:95,capacity:143},{size:120,capacity:166},{size:150,capacity:189},{size:185,capacity:216},{size:240,capacity:254}],
  B1: [{size:2.5,capacity:20},{size:4,capacity:27},{size:6,capacity:35},{size:10,capacity:48},{size:16,capacity:64},{size:25,capacity:84},{size:35,capacity:105},{size:50,capacity:128},{size:70,capacity:162},{size:95,capacity:197},{size:120,capacity:227},{size:150,capacity:259},{size:185,capacity:295},{size:240,capacity:347}],
  B2: [{size:2.5,capacity:19.5},{size:4,capacity:26},{size:6,capacity:33},{size:10,capacity:45},{size:16,capacity:60},{size:25,capacity:79},{size:35,capacity:98},{size:50,capacity:119},{size:70,capacity:151},{size:95,capacity:184},{size:120,capacity:212},{size:150,capacity:242},{size:185,capacity:276},{size:240,capacity:325}],
  C: [{size:2.5,capacity:23},{size:4,capacity:31},{size:6,capacity:40},{size:10,capacity:55},{size:16,capacity:74},{size:25,capacity:98},{size:35,capacity:121},{size:50,capacity:147},{size:70,capacity:187},{size:95,capacity:227},{size:120,capacity:263},{size:150,capacity:301},{size:185,capacity:344},{size:240,capacity:404}],
  D: [{size:2.5,capacity:22},{size:4,capacity:29},{size:6,capacity:36},{size:10,capacity:48},{size:16,capacity:62},{size:25,capacity:80},{size:35,capacity:96},{size:50,capacity:114},{size:70,capacity:141},{size:95,capacity:167},{size:120,capacity:190},{size:150,capacity:216},{size:185,capacity:244},{size:240,capacity:280}],
  E: [{size:2.5,capacity:24},{size:4,capacity:32},{size:6,capacity:42},{size:10,capacity:58},{size:16,capacity:77},{size:25,capacity:103},{size:35,capacity:127},{size:50,capacity:153},{size:70,capacity:196},{size:95,capacity:237},{size:120,capacity:274},{size:150,capacity:314},{size:185,capacity:359},{size:240,capacity:423}],
  F: [{size:2.5,capacity:24},{size:4,capacity:32},{size:6,capacity:42},{size:10,capacity:58},{size:16,capacity:77},{size:25,capacity:103},{size:35,capacity:127},{size:50,capacity:153},{size:70,capacity:196},{size:95,capacity:237},{size:120,capacity:274},{size:150,capacity:314},{size:185,capacity:359},{size:240,capacity:423}],
  G: [{size:2.5,capacity:28},{size:4,capacity:38},{size:6,capacity:49},{size:10,capacity:67},{size:16,capacity:89},{size:25,capacity:118},{size:35,capacity:146},{size:50,capacity:177},{size:70,capacity:226},{size:95,capacity:275},{size:120,capacity:318},{size:150,capacity:364},{size:185,capacity:416},{size:240,capacity:490},{size:300,capacity:560}],
};

// Voltage Drop Factors (mV/A/m) - Simplified representative values
// For Copper, 70°C (PVC) or 90°C (XLPE), 50Hz
export const VOLTAGE_DROP_FACTORS: Record<number, { pvc: number; xlpe: number; al_pvc: number; al_xlpe: number }> = {
  1.5: { pvc: 29, xlpe: 31, al_pvc: 48, al_xlpe: 51 },
  2.5: { pvc: 18, xlpe: 19, al_pvc: 30, al_xlpe: 32 },
  4: { pvc: 11, xlpe: 12, al_pvc: 18, al_xlpe: 19 },
  6: { pvc: 7.3, xlpe: 7.9, al_pvc: 12, al_xlpe: 13 },
  10: { pvc: 4.4, xlpe: 4.7, al_pvc: 7.3, al_xlpe: 7.8 },
  16: { pvc: 2.8, xlpe: 3.0, al_pvc: 4.6, al_xlpe: 4.9 },
  25: { pvc: 1.8, xlpe: 1.9, al_pvc: 3.0, al_xlpe: 3.2 },
  35: { pvc: 1.3, xlpe: 1.4, al_pvc: 2.1, al_xlpe: 2.3 },
  50: { pvc: 0.93, xlpe: 1.0, al_pvc: 1.5, al_xlpe: 1.6 },
  70: { pvc: 0.63, xlpe: 0.68, al_pvc: 1.0, al_xlpe: 1.1 },
  95: { pvc: 0.46, xlpe: 0.50, al_pvc: 0.76, al_xlpe: 0.82 },
  120: { pvc: 0.36, xlpe: 0.39, al_pvc: 0.60, al_xlpe: 0.64 },
  150: { pvc: 0.29, xlpe: 0.31, al_pvc: 0.48, al_xlpe: 0.51 },
  185: { pvc: 0.23, xlpe: 0.25, al_pvc: 0.38, al_xlpe: 0.41 },
  240: { pvc: 0.18, xlpe: 0.19, al_pvc: 0.30, al_xlpe: 0.32 },
  300: { pvc: 0.15, xlpe: 0.16, al_pvc: 0.25, al_xlpe: 0.27 },
};
